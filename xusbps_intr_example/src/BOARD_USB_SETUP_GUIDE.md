# ZYNQ7010开发板USB配置指南

## USB接口和跳线设置说明

### 🔌 USB接口类型
根据开发板手册，您的开发板提供了两个USB接口：

1. **J3 - Host USB接口** (USB Type A 母座)
2. **J4 - Slave USB接口** (Micro USB)

### ⚡ 跳线设置 (J5, J6)

根据表6-3的说明：

| 跳线状态 | USB模式 | 说明 |
|---------|---------|------|
| **J5和J6安装跳线帽** | **HOST模式** | 开发板作为主设备，USB口连接鼠标、键盘、USB等外设 |
| **J5和J6不安装跳线帽** | **OTG/Slave模式** | 开发板作为从设备，USB口连接电脑 |

### 📋 当前项目的正确配置

由于我们开发的是**USB CDC-ACM虚拟串口设备**，ZYNQ7010需要作为**USB从设备**连接到电脑：

#### ✅ 正确设置：
1. **跳线配置**: 
   - **移除J5跳线帽**
   - **移除J6跳线帽**
   - 这样设置为OTG/Slave模式

2. **USB连接**:
   - 使用**J4接口** (Micro USB)
   - 连接到电脑的USB端口
   - **不要使用J3接口** (那是Host模式用的)

### 🔧 硬件连接示意图

```
电脑USB端口 ←→ USB线缆 ←→ J4 (Micro USB) [ZYNQ7010开发板]
                                            ↑
                                       J5, J6 无跳线帽
```

### ⚠️ 重要注意事项

1. **跳线帽位置**:
   - 确保J5和J6都**完全移除**跳线帽
   - 如果跳线帽还在，会导致USB模式错误

2. **USB线缆**:
   - 使用质量良好的Micro USB线缆
   - 确保线缆支持数据传输（不仅仅是充电线）

3. **供电**:
   - 开发板可以通过USB供电
   - 或者使用独立电源适配器

4. **USB端口选择**:
   - 优先使用电脑的USB 2.0端口
   - 避免使用USB Hub，直接连接到主板USB口

### 📝 设置步骤

1. **断电操作**:
   ```
   1. 关闭开发板电源
   2. 移除J5跳线帽
   3. 移除J6跳线帽
   ```

2. **连接USB**:
   ```
   1. 将Micro USB线连接到J4接口
   2. 另一端连接到电脑USB端口
   ```

3. **上电测试**:
   ```
   1. 开启开发板电源
   2. 通过UART监控启动信息
   3. 观察USB枚举调试输出
   ```

### 🎯 验证配置正确性

连接后，在UART调试输出中应该看到：
```
ZYNQ7010 USB CDC-ACM Virtual Serial Port - Deep Compatibility Mode
=================================================================
Hardware: USB3320C-EZK PHY Controller
Status: Starting USB enumeration debugging...
```

如果配置正确，当电脑检测到USB设备时，还会看到：
```
检测到USB复位
USB Setup: Type=0x80, Req=0x06...
Device Descriptor sent successfully: 18 bytes
USB枚举完成，设备已连接
```

### 🚨 常见错误

1. **跳线帽未移除** → USB工作在Host模式 → 无法作为设备被电脑识别
2. **使用J3接口** → 连接到Host接口 → 设备无法枚举
3. **劣质USB线** → 数据传输失败 → 枚举过程中断

### 📱 最终验证

配置正确后：
- Windows设备管理器应显示CDC设备
- 不应再出现"未知USB设备"错误
- 设备应被识别为虚拟串口(COM端口)

---
**重要**: 请确保在断电状态下调整跳线帽，然后重新连接USB并上电测试。
